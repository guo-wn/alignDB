#----------------------------------------------------------#
# HumanvsCGOR away from gene and non repeat
#----------------------------------------------------------#
# Gene set padded by 5000 and then invert.
# Trim intergenic set by 5000 is not right.
perl ~/Scripts/alignDB/slice/write_runlist_feature.pl \
    -d HumanvsCGOR -e human_65 --feature gene --inset "-5000" --invert -l 1000 --parallel 8
perl ~/Scripts/alignDB/slice/merge_runlist.pl -d HumanvsCGOR_gene_inset-5000_invert/

perl ~/Scripts/alignDB/slice/write_align_slice.pl \
    -d HumanvsCGOR --outgroup -y HumanvsCGOR_gene_inset-5000_invert/HumanvsCGOR_gene_inset-5000_invert.yml --parallel 8
mv ~/Scripts/alignDB/slice/HumanvsCGOR_gene_inset-5000_invert ~/Scripts/alignDB/slice/HumanvsCGOR_away_gene
mv ~/Scripts/alignDB/slice/HumanvsCGOR_away_gene ~/data/alignment/feature

perl ~/Scripts/alignDB/alignDB.pl \
    -d HumanvsCGOR_away_gene -e human_65 \
    --outgroup --block --id ~/data/alignment/primates/id2name.csv \
    -da ~/data/alignment/feature/HumanvsCGOR_away_gene \
    -lt 1000 --parallel 8 --run gc

perl ~/Scripts/alignDB/slice/write_runlist_feature.pl \
    -d HumanvsCGOR -e human_65 --feature non_repeat -l 1000 --parallel 8
perl ~/Scripts/alignDB/slice/merge_runlist.pl -d HumanvsCGOR_non_repeat

perl ~/Scripts/alignDB/slice/compare_runlist.pl -op intersect \
    -f1 HumanvsCGOR_gene_inset-5000_invert/HumanvsCGOR_gene_inset-5000_invert.yml \
    -f2 HumanvsCGOR_non_repeat/HumanvsCGOR_non_repeat.yml \
    -o HumanvsCGOR_away_gene_non_repeat.yml
mkdir HumanvsCGOR_away_gene_non_repeat
mv HumanvsCGOR_away_gene_non_repeat.yml HumanvsCGOR_away_gene_non_repeat

perl ~/Scripts/alignDB/slice/write_align_slice.pl \
    -d HumanvsCGOR --outgroup -y HumanvsCGOR_away_gene_non_repeat/HumanvsCGOR_away_gene_non_repeat.yml --parallel 8
mv ~/Scripts/alignDB/slice/HumanvsCGOR_away_gene_non_repeat ~/data/alignment/feature

perl ~/Scripts/alignDB/alignDB.pl \
    -d HumanvsCGOR_away_gene_non_repeat -e human_65 \
    --outgroup --block --id ~/data/alignment/primates/id2name.csv \
    -da ~/data/alignment/feature/HumanvsCGOR_away_gene_non_repeat \
    -lt 1000 -st 0 -ct 0 --parallel 8 --run gc


#----------------------------------------------------------#
# HumanvsCGOR_intron
#----------------------------------------------------------#
perl ~/Scripts/alignDB/slice/write_runlist_feature.pl \
    -d HumanvsCGOR -e human_65 --feature intron -l 1000 --parallel 8
perl ~/Scripts/alignDB/slice/merge_runlist.pl -d HumanvsCGOR_intron

mv ~/Scripts/alignDB/slice/HumanvsCGOR_intron ~/data/alignment/feature
perl ~/Scripts/alignDB/slice/write_align_slice.pl \
    -d HumanvsCGOR --outgroup -y ~/data/alignment/feature/HumanvsCGOR_intron/HumanvsCGOR_intron.yml --parallel 8

perl ~/Scripts/alignDB/alignDB.pl \
    -d HumanvsCGOR_intron -e human_65 \
    --outgroup --block --id ~/data/alignment/primates/id2name.csv \
    -da ~/data/alignment/feature/HumanvsCGOR_intron  \
    -lt 1000 --parallel 8 --run gc

#----------------------------------------------------------#
# HumanvsCGOR GC isochore
#----------------------------------------------------------#
cd ~/Scripts/alignDB/slice
perl ~/Scripts/alignDB/slice/write_runlist_feature.pl \
    -d HumanvsCGOR -e human_65 --feature slice -l 1000 --parallel 8
perl ~/Scripts/alignDB/slice/merge_runlist.pl -d HumanvsCGOR_slice/

cp ~/Scripts/alignDB/slice/HumanvsCGOR_slice/HumanvsCGOR_slice.yml ~/Scripts/iso
cd ~/Scripts/iso
perl ~/Scripts/iso/isobin.pl -d ~/data/alignment/primates/human_chr/ -b 10 -s ~/Scripts/iso/HumanvsCGOR_slice.yml --debug

cd ~/Scripts/alignDB/slice/

for i in `seq 0 9`; do
    mkdir ~/Scripts/alignDB/slice/bin$i
    cp ~/Scripts/iso/bin$i.yml ~/Scripts/alignDB/slice/bin$i
done 

for i in `seq 0 9`; do
    perl ~/Scripts/alignDB/slice/write_align_slice.pl -d HumanvsCGOR --outgroup -y bin$i/bin$i.yml --parallel 8
done 

mv ~/Scripts/alignDB/slice/bin[0-9] ~/data/alignment/feature

for i in `seq 0 9`; do
    perl ~/Scripts/alignDB/alignDB.pl \
        -d HumanvsCGOR_bin$i -e humanb_65 \
        --outgroup --block --id ~/data/alignment/primates/id2name.csv \
        -da ~/data/alignment/feature/bin$i \
        -lt 1000 --parallel 12 --run gc
done 
