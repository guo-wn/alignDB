# human
mkdir ~/data/alignment/soybean
mkdir ~/data/alignment/soybean/soybean_65
cd ~/data/ensemblgenomes12_65/plants/fasta/glycine_max/dna
gzip -d -c Glycine_max.1.0.12.dna.toplevel.fa.gz > toplevel.fa
~/bin/x86_64/faSplit byname toplevel.fa ~/data/alignment/soybean/soybean_65/
rm toplevel.fa

mkdir ~/data/alignment/soybean
mkdir ~/data/alignment/soybean/soybean_65

cd ~/data/alignment/soybean/soybean_65
find ~/data/ensemblgenomes12_65/plants/fasta/glycine_max/dna/ -name "*dna.toplevel*" | xargs gzip -d -c > toplevel.fa
~/bin/x86_64/faCount toplevel.fa | perl -aln -e 'next if $F[0] eq 'total'; print $F[0] if $F[1] > 100000; print $F[0] if $F[1] > 10000  and $F[6]/$F[1] < 0.05' | uniq > listFile
~/bin/x86_64/faSomeRecords toplevel.fa listFile toplevel.filtered.fa
~/bin/x86_64/faSplit byname toplevel.filtered.fa .
rm toplevel.fa toplevel.filtered.fa listFile

perl ~/Scripts/alignDB/util/build_ensembl.pl --initdb --db soybean_65 --ensembl ~/data/ensemblgenomes12_65/plants/mysql/glycine_max_core_12_65_1/

perl ~/Scripts/alignDB/util/write_masked_chr.pl -e soybean_65
perl ~/Scripts/alignDB/util/write_masked_chr.pl -y soybean_65_repeat.yml --dir ~/data/alignment/soybean/soybean_65

find . -name "*fa" | xargs rm
~/perl5/bin/rename 's/\.masked//' *.fa.masked

if [ -f chrUn.fasta ]; then RepeatMasker ~/data/alignment/soybean/soybean_65/chrUn.fasta -species "Glycine max" -xsmall --parallel 4; fi;

if [ -f chrUn.fasta.masked ]; then ~/perl5/bin/rename 's/fasta.masked$/fa/' *.fasta.masked; fi;
find ~/data/alignment/soybean/soybean_65/ -type f -name "*fasta*" | xargs rm 

